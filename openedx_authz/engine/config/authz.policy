############################################
# Open edX AuthZ â€” Casbin Policy Configuration
#
# This file defines policies that work with the model configuration.
# Uses namespaced subjects, actions, and scopes for maximum flexibility.
############################################

# Policy definitions - format: p = subject(role), action, scope, effect
# For role definitions use: lib^*, course^*, org^* to specify the scope of the role

# Library Admin Role Policies
p, role^library_admin, act^content_libraries.view_library, lib^*, allow
p, role^library_admin, act^content_libraries.manage_library_tags, lib^*, allow
p, role^library_admin, act^content_libraries.delete_library, lib^*, allow
p, role^library_admin, act^content_libraries.edit_library_content, lib^*, allow
p, role^library_admin, act^content_libraries.publish_library_content, lib^*, allow
p, role^library_admin, act^content_libraries.reuse_library_content, lib^*, allow
p, role^library_admin, act^content_libraries.view_library_team, lib^*, allow
p, role^library_admin, act^content_libraries.manage_library_team, lib^*, allow
p, role^library_admin, act^content_libraries.create_library_collection, lib^*, allow
p, role^library_admin, act^content_libraries.edit_library_collection, lib^*, allow
p, role^library_admin, act^content_libraries.delete_library_collection, lib^*, allow

# Library Author Role Policies
p, role^library_author, act^content_libraries.view_library, lib^*, allow
p, role^library_author, act^content_libraries.manage_library_tags, lib^*, allow
p, role^library_author, act^content_libraries.edit_library_content, lib^*, allow
p, role^library_author, act^content_libraries.publish_library_content, lib^*, allow
p, role^library_author, act^content_libraries.reuse_library_content, lib^*, allow
p, role^library_author, act^content_libraries.view_library_team, lib^*, allow
p, role^library_author, act^content_libraries.create_library_collection, lib^*, allow
p, role^library_author, act^content_libraries.edit_library_collection, lib^*, allow
p, role^library_author, act^content_libraries.delete_library_collection, lib^*, allow

# Library Contributor Role Policies
p, role^library_contributor, act^content_libraries.view_library, lib^*, allow
p, role^library_contributor, act^content_libraries.manage_library_tags, lib^*, allow
p, role^library_contributor, act^content_libraries.edit_library_content, lib^*, allow
p, role^library_contributor, act^content_libraries.reuse_library_content, lib^*, allow
p, role^library_contributor, act^content_libraries.view_library_team, lib^*, allow
p, role^library_contributor, act^content_libraries.create_library_collection, lib^*, allow
p, role^library_contributor, act^content_libraries.edit_library_collection, lib^*, allow
p, role^library_contributor, act^content_libraries.delete_library_collection, lib^*, allow

# Library User Role Policies
p, role^library_user, act^content_libraries.view_library, lib^*, allow
p, role^library_user, act^content_libraries.reuse_library_content, lib^*, allow
p, role^library_user, act^content_libraries.view_library_team, lib^*, allow

# Action Inheritance (g2) - format: g2 = granted_action, implied_action
# Higher-level permissions automatically grant lower-level permissions
# If a user has the granted_action, they also have the implied_action
# Example: g2, act^content_libraries.delete_library, act^content_libraries.view_library means delete permission includes view permission
# Library
g2, act^content_libraries.manage_library_tags, act^content_libraries.edit_library_content
g2, act^content_libraries.delete_library, act^content_libraries.edit_library_content

# Content
g2, act^content_libraries.publish_library_content, act^content_libraries.edit_library_content
g2, act^content_libraries.edit_library_content, act^content_libraries.view_library
g2, act^content_libraries.reuse_library_content, act^content_libraries.view_library
g2, act^content_libraries.publish_library_content, act^content_libraries.view_library

# Team
g2, act^content_libraries.manage_library_team, act^content_libraries.view_library_team

# Collections
g2, act^content_libraries.delete_library_collection, act^content_libraries.edit_library_collection
g2, act^content_libraries.create_library_collection, act^content_libraries.edit_library_collection
g2, act^content_libraries.edit_library_collection, act^content_libraries.view_library


## Course Policies

# Course Auditor Role Policies
p, role^course_auditor, act^courses.view_course, course-v1^*, allow
p, role^course_auditor, act^courses.view_course_updates, course-v1^*, allow
p, role^course_auditor, act^courses.view_pages_and_resources, course-v1^*, allow
p, role^course_auditor, act^courses.view_files, course-v1^*, allow
p, role^course_auditor, act^courses.view_grading_settings, course-v1^*, allow
p, role^course_auditor, act^courses.view_checklists, course-v1^*, allow
p, role^course_auditor, act^courses.view_course_team, course-v1^*, allow
p, role^course_auditor, act^courses.view_schedule_and_details, course-v1^*, allow

# Course Editor Role Policies
p, role^course_editor, act^courses.view_course, course-v1^*, allow
p, role^course_editor, act^courses.view_course_updates, course-v1^*, allow
p, role^course_editor, act^courses.view_pages_and_resources, course-v1^*, allow
p, role^course_editor, act^courses.view_files, course-v1^*, allow
p, role^course_editor, act^courses.view_grading_settings, course-v1^*, allow
p, role^course_editor, act^courses.view_checklists, course-v1^*, allow
p, role^course_editor, act^courses.view_course_team, course-v1^*, allow
p, role^course_editor, act^courses.view_schedule_and_details, course-v1^*, allow
p, role^course_editor, act^courses.edit_course_content, course-v1^*, allow
p, role^course_editor, act^courses.manage_library_updates, course-v1^*, allow
p, role^course_editor, act^courses.manage_course_updates, course-v1^*, allow
p, role^course_editor, act^courses.manage_pages_and_resources, course-v1^*, allow
p, role^course_editor, act^courses.create_files, course-v1^*, allow
p, role^course_editor, act^courses.edit_files, course-v1^*, allow
p, role^course_editor, act^courses.edit_grading_settings, course-v1^*, allow
p, role^course_editor, act^courses.manage_group_configurations, course-v1^*, allow
p, role^course_editor, act^courses.edit_details, course-v1^*, allow
p, role^course_editor, act^courses.manage_tags, course-v1^*, allow

# Course Staff Role Policies
p, role^course_staff, act^courses.legacy_staff_role_permissions, course-v1^*, allow
p, role^course_staff, act^courses.view_course, course-v1^*, allow
p, role^course_staff, act^courses.view_course_updates, course-v1^*, allow
p, role^course_staff, act^courses.view_pages_and_resources, course-v1^*, allow
p, role^course_staff, act^courses.view_files, course-v1^*, allow
p, role^course_staff, act^courses.view_grading_settings, course-v1^*, allow
p, role^course_staff, act^courses.view_checklists, course-v1^*, allow
p, role^course_staff, act^courses.view_course_team, course-v1^*, allow
p, role^course_staff, act^courses.view_schedule_and_details, course-v1^*, allow
p, role^course_staff, act^courses.edit_course_content, course-v1^*, allow
p, role^course_staff, act^courses.manage_library_updates, course-v1^*, allow
p, role^course_staff, act^courses.manage_course_updates, course-v1^*, allow
p, role^course_staff, act^courses.manage_pages_and_resources, course-v1^*, allow
p, role^course_staff, act^courses.create_files, course-v1^*, allow
p, role^course_staff, act^courses.edit_files, course-v1^*, allow
p, role^course_staff, act^courses.edit_grading_settings, course-v1^*, allow
p, role^course_staff, act^courses.manage_group_configurations, course-v1^*, allow
p, role^course_staff, act^courses.edit_details, course-v1^*, allow
p, role^course_staff, act^courses.manage_tags, course-v1^*, allow
p, role^course_staff, act^courses.publish_course_content, course-v1^*, allow
p, role^course_staff, act^courses.delete_files, course-v1^*, allow
p, role^course_staff, act^courses.edit_schedule, course-v1^*, allow
p, role^course_staff, act^courses.manage_advanced_settings, course-v1^*, allow
p, role^course_staff, act^courses.manage_certificates, course-v1^*, allow
p, role^course_staff, act^courses.import_course, course-v1^*, allow
p, role^course_staff, act^courses.export_course, course-v1^*, allow
p, role^course_staff, act^courses.export_tags, course-v1^*, allow


# Course Admin Role Policies
p, role^course_admin, act^courses.legacy_instructor_role_permissions, course-v1^*, allow
p, role^course_admin, act^courses.view_course, course-v1^*, allow
p, role^course_admin, act^courses.view_course_updates, course-v1^*, allow
p, role^course_admin, act^courses.view_pages_and_resources, course-v1^*, allow
p, role^course_admin, act^courses.view_files, course-v1^*, allow
p, role^course_admin, act^courses.view_grading_settings, course-v1^*, allow
p, role^course_admin, act^courses.view_checklists, course-v1^*, allow
p, role^course_admin, act^courses.view_course_team, course-v1^*, allow
p, role^course_admin, act^courses.view_schedule_and_details, course-v1^*, allow
p, role^course_admin, act^courses.edit_course_content, course-v1^*, allow
p, role^course_admin, act^courses.manage_library_updates, course-v1^*, allow
p, role^course_admin, act^courses.manage_course_updates, course-v1^*, allow
p, role^course_admin, act^courses.manage_pages_and_resources, course-v1^*, allow
p, role^course_admin, act^courses.create_files, course-v1^*, allow
p, role^course_admin, act^courses.edit_files, course-v1^*, allow
p, role^course_admin, act^courses.edit_grading_settings, course-v1^*, allow
p, role^course_admin, act^courses.manage_group_configurations, course-v1^*, allow
p, role^course_admin, act^courses.edit_details, course-v1^*, allow
p, role^course_admin, act^courses.manage_tags, course-v1^*, allow
p, role^course_admin, act^courses.publish_course_content, course-v1^*, allow
p, role^course_admin, act^courses.delete_files, course-v1^*, allow
p, role^course_admin, act^courses.edit_schedule, course-v1^*, allow
p, role^course_admin, act^courses.manage_advanced_settings, course-v1^*, allow
p, role^course_admin, act^courses.manage_certificates, course-v1^*, allow
p, role^course_admin, act^courses.import_course, course-v1^*, allow
p, role^course_admin, act^courses.export_course, course-v1^*, allow
p, role^course_admin, act^courses.export_tags, course-v1^*, allow
p, role^course_admin, act^courses.manage_course_team, course-v1^*, allow
p, role^course_admin, act^courses.manage_taxonomies, course-v1^*, allow


# Course Limited Staff Role Policies (legacy role)
p, role^course_limited_staff, act^courses.legacy_limited_staff_role_permissions, course-v1^*, allow

# Course Data Researcher Role Policies (legacy role)
p, role^course_data_researcher, act^courses.legacy_data_researcher_permissions, course-v1^*, allow

# Course Beta Tester Role Policies (legacy role)
p, role^course_beta_tester, act^courses.legacy_beta_tester_permissions, course-v1^*, allow
